# name: test/sql/catalog/function/test_table_macro_complex.test
# description: Test SELECT Macro
# group: [function]


statement ok
CREATE TABLE MACRO my_values(m,s) as select * from (values  (1.0*m+s,'adam'), (2.0*m+s,'ben'),
(3.0*m+s,'cris'), (4.0*m+s,'desmond'),(5.0*m+s, 'eric'));

query I
SELECT sum(col0) from my_values(10.0,5.0);
----
175.00

# recursive union select  macro
statement ok
CREATE TABLE MACRO my_values_union(m1,s1,m2,s2) as select * from my_values(m1,s1) UNION select * from my_values(m2,s2);

query I
select max(col0)  from my_values_union(1.0,2.0,3.0,20.0);
----
35.00

# ranges
statement ok
CREATE TABLE MACRO dates_between(date_min, date_max, ilimit:=100) AS WITH dates(date) AS
(SELECT * FROM range(date '0000-01-01', date '3000-01-01', interval '1' month))
SELECT * FROM dates WHERE date between date_min AND date_max;


query T
select * from dates_between('2021-01-01', '2021-02-04');
----
2021-01-01 00:00:00
2021-02-01 00:00:00







